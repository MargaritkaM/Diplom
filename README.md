# Дипломный проект

## Описание приложения 

### Бизнес-часть

Приложение — это веб-сервис, который предлагает купить тур по определённой цене двумя способами:

1. Обычная оплата по дебетовой карте.
2. Уникальная технология: выдача кредита по данным банковской карты.

![image](https://user-images.githubusercontent.com/106307755/222179183-e15ce001-1e5a-4833-bab1-8fafe1ce2df4.png)

Само приложение не обрабатывает данные по картам, а пересылает их банковским сервисам:
* сервису платежей, далее Payment Gate;
* кредитному сервису, далее Credit Gate.

Приложение в собственной СУБД должно сохранять информацию о том, успешно ли был совершён платёж и каким способом. Данные карт при этом сохранять не допускается.

*Важно: в реальной жизни приложение не должно пропускать через себя данные карт, если у него нет PCI DSS, но мы сделали именно так ;)*

### Техническая часть

Само приложение расположено в файле [`aqa-shop.jar`](aqa-shop.jar) и запускается стандартным способом `java -jar aqa-shop.jar` на порту 8080.

В файле [`application.properties`](application.properties) приведён ряд типовых настроек:
* учётные данные и URL для подключения к СУБД;
* URL-адреса банковских сервисов.

### СУБД

Заявлена поддержка двух СУБД. Вы должны это проверить:

* MySQL;
* PostgreSQL.

Учётные данные и URL для подключения задаются в файле [`application.properties`](application.properties).

### Банковские сервисы

Доступ к реальным банковским сервисам не даётся, поэтому разработчики подготовили для вас симулятор банковских сервисов, который может принимать запросы в нужном формате и генерировать ответы.

Симулятор написан на Node.js, поэтому для запуска вам нужен либо Docker, либо установленный Node.js. Симулятор расположен в каталоге [gate-simulator](gate-simulator). Для запуска нужно перейти в этот каталог. 

Симулятор запускается командой `npm start` на порту 9999. Он позволяет генерировать предопределённые ответы для заданного набора карт. Набор карт представлен в формате JSON в файле [`data.json`](gate-simulator/data.json).

Обратите внимание: разработчики сделали один сервис, симулирующий и Payment Gate, и Credit Gate.

## Задача

Ваша ключевая задача — автоматизировать позитивные и негативные сценарии покупки тура.

Задача разбита на 4 этапа:

1. Планирование автоматизации тестирования.
2. Непосредственно сама автоматизация.
3. Подготовка отчётных документов по итогам автоматизированного тестирования.
4. Подготовка отчётных документов по итогам автоматизации.


## Решение

### План автоматизации и отчетные документы:
* [План автоматизации](https://github.com/MargaritkaM/Diplom/blob/master/Plan.md)
* [Отчётные документы по итогам автоматизированного тестирования](https://github.com/MargaritkaM/Diplom/blob/master/Report.md)
* [Отчётные документы по итогам автоматизации](https://github.com/MargaritkaM/Diplom/blob/master/Summary.md)


### Файлы и директории:

- Файлы docker-compose.yml, application.properties находятся в корне проекта
- Jar файл и gate-simulator находятся в папке artifacts
- Код тестов находится в папке src/test/java/test/

### Описание процедуры запуска автотестов:

1. Склонировать [проект](https://github.com/MargaritkaM/Diplom.git)

2. Параметры [application.properties](https://github.com/MargaritkaM/Diplom/blob/master/application.properties)

3. Параметры [docker-compose.yml](https://github.com/MargaritkaM/Diplom/blob/master/docker-compose.yml)
4. Склонировать проект на удаленную машину для запуска контейнера
 
 `адрес - 89.223.70.43`
 
5. Поднять контейнеры postgresql, Node.js:
 
 ` директория Diplom5-Diplom`
 
 ` команда docker-compose up`
 
6. Запустить jar файл через команду в терминале IDEA:

 ` java "-Dspring.datasource.url=jdbc:postgresql://89.223.70.43:5432/app" -jar artifacts/aqa-shop.jar`
 
7. Запустить тесты используя зеленый треугольник в IDEA либо через команду в терминале:

 ` gradlew clean test -Ddb.url=jdbc:postgresql://89.223.70.43:5432/app -Dapp.url=http://localhost:8080`
 
8. Остановить контейнеры через команду в терминале:

 ` docker-compose down`
